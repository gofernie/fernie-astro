---
import Site from "../layouts/Site.astro";

const pageTitle = "Fernie Real Estate";
const description = "Fast, mobile-first site powered by Google Sheets.";

/* Image helpers:
   - In local dev: serve /images/montane.webp directly.
   - In Netlify production: use Image CDN for right-sized variants. */
const raw = "/images/montane.webp";
function cdn(url, w, h) {
  return `/.netlify/images?url=${encodeURIComponent(url)}&w=${w}${h ? `&h=${h}&fit=cover` : "&fit=cover"}`;
}
const heroSrc = import.meta.env.PROD ? cdn(raw, 1600, 900) : raw;
const heroSrcSet = import.meta.env.PROD
  ? [960, 1280, 1600, 1920].map(w => `${cdn(raw, w, Math.round(w * 0.5625))} ${w}w`).join(", ")
  : undefined;
const heroW = 1600, heroH = 900; // reserve aspect ratio to prevent CLS
---
<Site title={pageTitle} description={description} active="home">
  <!-- Preload hero for better LCP -->
  <fragment slot="head">
    <link rel="preload" as="image" href={heroSrc} fetchpriority="high" />
  </fragment>

  <!-- Full-bleed 80vh hero under sticky nav -->
  <div slot="hero" class="home-hero">
    <style>
      .home-hero{position:relative}
      .hero80{width:100%;height:80vh;object-fit:cover;display:block;border-bottom:1px solid #eee}
      .shade{position:absolute;inset:0;background:
        linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.25) 40%, rgba(0,0,0,.0) 70%)}
      .content{position:absolute;inset:0;display:flex;align-items:flex-end}
      .inner{width:100%;max-width:var(--max);margin:0 auto;padding:calc(var(--pad) * 2);color:#fff}
      .title{margin:0 0 8px;font-size:clamp(36px,6vw,64px);line-height:1.1}
      .lede{margin:0 0 16px;font-size:clamp(16px,2.4vw,20px);opacity:.95}
      .cta{display:flex;gap:12px;flex-wrap:wrap}
      .btn{display:inline-block;padding:12px 16px;border-radius:12px;text-decoration:none}
      .btn.primary{background:#111;color:#fff;border:1px solid #111}
      .btn.ghost{color:#fff;border:1px solid rgba(255,255,255,.7)}
    </style>

    <img
      class="hero80"
      src={heroSrc}
      srcset={heroSrcSet}
      sizes="100vw"
      alt="Montane neighbourhood, Fernie"
      width={heroW} height={heroH}
      fetchpriority="high" decoding="async"
    />
    <div class="shade"></div>

    <div class="content">
      <div class="inner">
        <h1 class="title">Find your place in Fernie</h1>
        <p class="lede">Browse neighbourhoods with trail access, schools, views, and more.</p>
        <div class="cta">
          <a class="btn primary" href="/neighbourhoods">Explore neighbourhoods</a>
          <a class="btn ghost" href="#">Talk to Chris</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Optional extra content below hero -->
  <section style="padding:24px 0">
    <!-- add quick links or leave empty -->
  </section>
</Site>
